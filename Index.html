<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>MSC MAGNIFICA ‚Äì VUELTA AL MUNDO 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    #map-container {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    #header {
      padding: 10px 16px;
      background: linear-gradient(90deg, #004d40 0%, #00796b 40%, #ff6f00 100%);
      color: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    #header h1 {
      margin: 0;
      font-size: 20px;
      font-weight: 700;
    }
    #header h2 {
      margin: 2px 0 0 0;
      font-size: 13px;
      font-weight: 400;
      opacity: 0.9;
    }
    #map {
      flex: 1;
      width: 100%;
    }
    .leaflet-popup-content {
      font-size: 14px;
      line-height: 1.4;
    }

    /* Leyenda */
    .legend {
      position: absolute;
      bottom: 16px;
      right: 16px;
      background: rgba(255,255,255,0.95);
      border-radius: 8px;
      padding: 10px 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.25);
      font-size: 12px;
      line-height: 1.4;
      z-index: 1200;
      max-width: 260px;
    }
    .legend-title {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 13px;
    }
    .legend-row {
      display: flex;
      align-items: center;
      margin-bottom: 4px;
    }
    .legend-color-box {
      width: 18px;
      height: 4px;
      margin-right: 6px;
      border-radius: 4px;
    }
    .legend-circle {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      margin-right: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.3);
      display: inline-block;
    }
    .legend-note {
      margin-top: 4px;
      font-size: 11px;
      color: #555;
    }
  </style>
</head>
<body>
<div id="map-container">
  <div id="header">
    <h1>MSC MAGNIFICA ‚Äì VUELTA AL MUNDO 2026</h1>
    <h2>Ruta completa con fechas, temperaturas, llegadas y salidas</h2>
  </div>
  <div id="map"></div>

  <!-- LEYENDA -->
  <div class="legend">
    <div class="legend-title">Leyenda</div>

    <div class="legend-row">
      <span class="legend-circle" style="background:#1976D2;"></span>
      <span>Europa / Mediterr√°neo</span>
    </div>
    <div class="legend-row">
      <span class="legend-circle" style="background:#FB8C00;"></span>
      <span>Atl√°ntico / Caribe</span>
    </div>
    <div class="legend-row">
      <span class="legend-circle" style="background:#E53935;"></span>
      <span>Am√©rica Pac√≠fico</span>
    </div>
    <div class="legend-row">
      <span class="legend-circle" style="background:#8E24AA;"></span>
      <span>Pac√≠fico / Ocean√≠a</span>
    </div>
    <div class="legend-row">
      <span class="legend-circle" style="background:#7CB342;"></span>
      <span>Asia</span>
    </div>
    <div class="legend-row">
      <span class="legend-circle" style="background:#00ACC1;"></span>
      <span>Oc√©ano √çndico / √Åfrica</span>
    </div>

    <div class="legend-row" style="margin-top:6px;">
      <span class="legend-circle" style="
        background: radial-gradient(circle at 30% 30%, #c8e6c9 0%, #4caf50 40%, #1b5e20 100%);
        border: 2px solid #1b5e20;
      "></span>
      <span>Inicio / final del viaje (Barcelona)</span>
    </div>

    <div class="legend-row">
      <span class="legend-color-box" style="background:#004d40;"></span>
      <span>Ruta ‚Äì sombra (mar profundo)</span>
    </div>
    <div class="legend-row">
      <span class="legend-color-box" style="background:#00bfa5;"></span>
      <span>Ruta ‚Äì trazo principal (turquesa)</span>
    </div>
    <div class="legend-row">
      <span class="legend-color-box" style="background:#ff6f00;"></span>
      <span>Ruta ‚Äì efecto atardecer (trazo discontinuo)</span>
    </div>

    <div class="legend-note">
      El n√∫mero del marcador es el ORDEN oficial del itinerario.  
      Algunos puertos aparecen dos veces (escalas dobles).
    </div>
  </div>
</div>

<!-- Leaflet JS -->
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>

<script>
// ---------------------------
// Datos de la ruta (de tu Excel)
// ---------------------------

const stops = [
  { orden: 1,  puerto: "üá™üá∏ Barcelona",                   fecha: "7 de enero de 2026",  dia: "Miercoles",  temperatura: "10 ¬∞C", llegada: null,     salida: "18:00",  region: "EUROPA" },
  { orden: 4,  puerto: "üáµüáπ Funchal (Madeira)",           fecha: "10 de enero de 2026", dia: "Sabado",    temperatura: "15 ¬∞C", llegada: "08:00",  salida: "17:00",  region: "ATLANTICO" },
  { orden: 10, puerto: "üáßüáß Bridgetown",                  fecha: "16 de enero de 2026", dia: "Viernes",   temperatura: "29 ¬∞C", llegada: "09:00",  salida: "19:00",  region: "ATLANTICO" },
  { orden: 11, puerto: "üáßüá∂ St. George‚Äôs (Granada)",     fecha: "17 de enero de 2026", dia: "Sabado",    temperatura: "28 ¬∞C", llegada: "07:00",  salida: "19:00",  region: "ATLANTICO" },
  { orden: 13, puerto: "üá®üáº Willemstad",                  fecha: "19 de enero de 2026", dia: "Lunes",     temperatura: "27 ¬∞C", llegada: "07:00",  salida: "19:00",  region: "ATLANTICO" },
  { orden: 15, puerto: "üá®üá¥ Cartagena de Indias",         fecha: "21 de enero de 2026", dia: "Miercoles", temperatura: "28 ¬∞C", llegada: "07:00",  salida: "19:00",  region: "ATLANTICO" },
  { orden: 17, puerto: "üá®üá∑ Puerto Lim√≥n",                fecha: "23 de enero de 2026", dia: "Viernes",   temperatura: "27 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "ATLANTICO" },
  { orden: 18, puerto: "üáµüá¶ Canal de Panam√°",             fecha: "24 de enero de 2026", dia: "Sabado",    temperatura: "27 ¬∞C", llegada: "06:00",  salida: "06:00",  region: "ATLANTICO" },
  { orden: 18, puerto: "üáµüá¶ Canal de Panam√°",             fecha: "24 de enero de 2026", dia: "Sabado",    temperatura: "27 ¬∞C", llegada: "18:00",  salida: "18:00",  region: "PACIFICO_AMERICA" },
  { orden: 20, puerto: "üá®üá∑ Puntarenas",                  fecha: "26 de enero de 2026", dia: "Lunes",     temperatura: "28 ¬∞C", llegada: "07:00",  salida: "19:00",  region: "PACIFICO_AMERICA" },
  { orden: 24, puerto: "üá¨üáπ Puerto Quetzal",              fecha: "28 de enero de 2026", dia: "Miercoles", temperatura: "27 ¬∞C", llegada: "09:00",  salida: "19:00",  region: "PACIFICO_AMERICA" },
  { orden: 25, puerto: "üá≤üáΩ Puerto Vallarta",             fecha: "31 de enero de 2026", dia: "Sabado",    temperatura: "22 ¬∞C", llegada: "07:00",  salida: "15:00",  region: "PACIFICO_AMERICA" },
  { orden: 26, puerto: "üá≤üáΩ Cabo San Lucas",              fecha: "1 de febrero de 2026",dia: "Domingo",   temperatura: "21 ¬∞C", llegada: "07:00",  salida: "14:00",  region: "PACIFICO_AMERICA" },
  { orden: 28, puerto: "üá∫üá∏ San Diego",                   fecha: "3 de febrero de 2026",dia: "Martes",    temperatura: "15 ¬∞C", llegada: "08:00",  salida: "20:00",  region: "PACIFICO_AMERICA" },
  { orden: 30, puerto: "üá∫üá∏ Los √Ångeles",                 fecha: "5 de febrero de 2026",dia: "Jueves",    temperatura: "16 ¬∞C", llegada: "08:00",  salida: "23:59",  region: "PACIFICO_AMERICA" },
  { orden: 31, puerto: "üá∫üá∏ Los √Ångeles",                 fecha: "6 de febrero de 2026",dia: "Viernes",   temperatura: "16 ¬∞C", llegada: "00.01",  salida: "14:00",  region: "PACIFICO_AMERICA" },
  { orden: 36, puerto: "üá∫üá∏ Hilo (Haw√°i)",                fecha: "11 de febrero de 2026",dia: "Miercoles",temperatura: "23 ¬∞C", llegada: "11:00",  salida: "21:00",  region: "PACIFICO_OCEANIA" },
  { orden: 42, puerto: "üá¶üá∏ Pago Pago",                   fecha: "17 de febrero de 2026",dia: "Martes",   temperatura: "28 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "PACIFICO_OCEANIA" },
  { orden: 44, puerto: "üáºüá∏ Apia (Samoa)",                fecha: "19 de febrero de 2026",dia: "Jueves",   temperatura: "28 ¬∞C", llegada: "08:00",  salida: "19:00",  region: "PACIFICO_OCEANIA" },
  { orden: 46, puerto: "üá´üáØ Suva (Fiyi)",                 fecha: "21 de febrero de 2026",dia: "Sabado",   temperatura: "27 ¬∞C", llegada: "08:00",  salida: "17:30",  region: "PACIFICO_OCEANIA" },
  { orden: 49, puerto: "üá≥üáø Auckland",                    fecha: "24 de febrero de 2026",dia: "Martes",   temperatura: "22 ¬∞C", llegada: "09:00",  salida: "23:59",  region: "PACIFICO_OCEANIA" },
  { orden: 50, puerto: "üá≥üáø Auckland",                    fecha: "25 de febrero de 2026",dia: "Miercoles",temperatura: "22 ¬∞C", llegada: "00:01",  salida: "20:00",  region: "PACIFICO_OCEANIA" },
  { orden: 52, puerto: "üá≥üáø Wellington",                  fecha: "27 de febrero de 2026",dia: "Viernes",  temperatura: "18 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "PACIFICO_OCEANIA" },
  { orden: 56, puerto: "üá¶üá∫ S√≠dney",                      fecha: "3 de marzo de 2026",  dia: "Martes",    temperatura: "23 ¬∞C", llegada: "06:30",  salida: "23.59",  region: "PACIFICO_OCEANIA" },
  { orden: 57, puerto: "üá¶üá∫ S√≠dney",                      fecha: "7 de marzo de 2026",  dia: "Sabado",    temperatura: "23 ¬∞C", llegada: "00:00",  salida: "18:00",  region: "PACIFICO_OCEANIA" },
  { orden: 61, puerto: "üá¶üá∫ Townsville",                  fecha: "8 de marzo de 2026",  dia: "Domingo",  temperatura: "28 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "PACIFICO_OCEANIA" },
  { orden: 62, puerto: "üá¶üá∫ Cairns",                      fecha: "9 de marzo de 2026",  dia: "Lunes",    temperatura: "28 ¬∞C", llegada: "07:00",  salida: "17:00",  region: "PACIFICO_OCEANIA" },
  { orden: 68, puerto: "üáµüá≠ Manila",                      fecha: "15 de marzo de 2026", dia: "Domingo",  temperatura: "29 ¬∞C", llegada: "16:00",  salida: "23.59",  region: "ASIA" },
  { orden: 69, puerto: "üáµüá≠ Manila",                      fecha: "16 de marzo de 2026", dia: "Lunes",    temperatura: "29 ¬∞C", llegada: "00.01",  salida: "17::00", region: "ASIA" },
  { orden: 71, puerto: "üáπüáº Keelung",                     fecha: "18 de marzo de 2026", dia: "Miercoles",temperatura: "19 ¬∞C", llegada: "09:00",  salida: "18:00",  region: "ASIA" },
  { orden: 72, puerto: "üáØüáµ Ishigaki",                    fecha: "19 de marzo de 2026", dia: "Jueves",   temperatura: "21 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "ASIA" },
  { orden: 73, puerto: "üáØüáµ Naha",                        fecha: "20 de marzo de 2026", dia: "Viernes",  temperatura: "20 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "ASIA" },
  { orden: 76, puerto: "üáØüáµ Tokio",                       fecha: "23 de marzo de 2026", dia: "Lunes",    temperatura: "12 ¬∞C", llegada: "08:00",  salida: "23.59",  region: "ASIA" },
  { orden: 77, puerto: "üáØüáµ Tokio",                       fecha: "24 de marzo de 2026", dia: "Martes",   temperatura: "12 ¬∞C", llegada: "00.01",  salida: "17:00",  region: "ASIA" },
  { orden: 79, puerto: "üáØüáµ Nagasaki",                    fecha: "26 de marzo de 2026", dia: "Jueves",   temperatura: "12 ¬∞C", llegada: "09:00",  salida: "18:00",  region: "ASIA" },
  { orden: 80, puerto: "üá∞üá∑ Busan",                       fecha: "27 de marzo de 2026", dia: "Mi‚àö¬©rcoles",temperatura: "10 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "ASIA" },
  { orden: 82, puerto: "üá®üá≥ Shanghai",                    fecha: "29 de marzo de 2026", dia: "Domingo",  temperatura: "12 ¬∞C", llegada: "07:00",  salida: "22:00",  region: "ASIA" },
  { orden: 85, puerto: "üá®üá≥ Hong Kong",                   fecha: "1 de abril de 2026",  dia: "Miercoles",temperatura: "22 ¬∞C", llegada: "08:00", salida: "22:00",  region: "ASIA" },
  { orden: 87, puerto: "üáªüá≥ Hue Da Nang",                 fecha: "3 de abril de 2026",  dia: "Viernes",  temperatura: "26 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "ASIA" },
  { orden: 90, puerto: "üá∏üá¨ Singapur",                    fecha: "6 de abril de 2026",  dia: "Lunes",    temperatura: "28 ¬∞C", llegada: "08:00",  salida: "19:00",  region: "ASIA" },
  { orden: 91, puerto: "üá≤üáæ Port Klang Kuala",            fecha: "7 de abril de 2026",  dia: "Martes",   temperatura: "28 ¬∞C", llegada: "09:00",  salida: "18:00",  region: "ASIA" },
  { orden: 92, puerto: "üá≤üáæ Penang",                      fecha: "8 de abril de 2026",  dia: "Miercoles",temperatura: "28 ¬∞C", llegada: "07:00",  salida: "16:00",  region: "ASIA" },
  { orden: 99, puerto: "üá∏üá® Port Victoria, isla Mah√©",    fecha: "15 de abril de 2026", dia: "Miercoles",temperatura: "28 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "INDICO_AFRICA" },
  { orden: 102,puerto: "üá≤üá∫ Port Louis",                  fecha: "18 de abril de 2026", dia: "Sabado",   temperatura: "26 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "INDICO_AFRICA" },
  { orden: 103,puerto: "üá≤üá∫ Port Louis",                  fecha: "19 de abril de 2026", dia: "Domingo",  temperatura: "26 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "INDICO_AFRICA" },
  { orden: 104,puerto: "üá∑üá™ La Possession",               fecha: "20 de abril de 2026", dia: "Lunes",    temperatura: "26 ¬∞C", llegada: null,     salida: null,     region: "INDICO_AFRICA" },
  { orden: 110,puerto: "üáøüá¶ Cape Town",                   fecha: "26 de abril de 2026", dia: "Domingo",  temperatura: "18 ¬∞C", llegada: "08:00",  salida: "00:00",  region: "INDICO_AFRICA" },
  { orden: 111,puerto: "üáøüá¶ Cape Town",                   fecha: "27 de abril de 2026", dia: "Lunes",    temperatura: "18 ¬∞C", llegada: "00:01",  salida: "18:00",  region: "INDICO_AFRICA" },
  { orden: 114,puerto: "üá≥üá¶ Walvis Bay",                  fecha: "30 de abril de 2026", dia: "Jueves",   temperatura: "20 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "INDICO_AFRICA" },
  { orden: 122,puerto: "üá®üáª Mindelo",                     fecha: "8 de mayo de 2026",   dia: "Viernes",  temperatura: "24 ¬∞C", llegada: "08:00",  salida: "17:00",  region: "ATLANTICO" },
  { orden: 128,puerto: "üáÆüáπ Civitavecchia",               fecha: "14 de mayo de 2026",  dia: "Jueves",   temperatura: "20 ¬∞C", llegada: "09:00",  salida: "20:00",  region: "EUROPA" },
  { orden: 129,puerto: "üáÆüáπ Livorno",                     fecha: "15 de mayo de 2026",  dia: "Viernes",  temperatura: "19 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "EUROPA" },
  { orden: 130,puerto: "üáÆüáπ G√©nova",                      fecha: "16 de mayo de 2026",  dia: "Sabado",   temperatura: "18 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "EUROPA" },
  { orden: 131,puerto: "üá´üá∑ Marsella",                    fecha: "17 de mayo de 2026",  dia: "Domingo",  temperatura: "18 ¬∞C", llegada: "08:00",  salida: "18:00",  region: "EUROPA" },
  { orden: 132,puerto: "üá™üá∏ Barcelona",                   fecha: "18 de mayo de 2026",  dia: "Lunes",    temperatura: "20 ¬∞C", llegada: "07:00",  salida: null,     region: "EUROPA" }
];

// ---------------------------
// Coordenadas de cada puerto
// ---------------------------

const coordMap = {
  "üá™üá∏ Barcelona":                [41.3851,   2.1734],
  "üáµüáπ Funchal (Madeira)":        [32.6486, -16.9080],
  "üáßüáß Bridgetown":               [13.0975, -59.6167],
  "üáßüá∂ St. George‚Äôs (Granada)":   [12.0526, -61.7416],
  "üá®üáº Willemstad":               [12.1091, -68.9317],
  "üá®üá¥ Cartagena de Indias":      [10.3910, -75.4794],
  "üá®üá∑ Puerto Lim√≥n":             [9.9907,  -83.0360],
  "üáµüá¶ Canal de Panam√°":          [8.9520,  -79.5550],
  "üá®üá∑ Puntarenas":               [9.9763,  -84.8384],
  "üá¨üáπ Puerto Quetzal":           [13.9210, -90.7880],
  "üá≤üáΩ Puerto Vallarta":          [20.6534, -105.2253],
  "üá≤üáΩ Cabo San Lucas":           [22.8905, -109.9167],
  "üá∫üá∏ San Diego":                [32.7157, -117.1611],
  "üá∫üá∏ Los √Ångeles":              [33.7405, -118.2728],
  "üá∫üá∏ Hilo (Haw√°i)":             [19.7070, -155.0810],
  "üá¶üá∏ Pago Pago":                [-14.2756,-170.7020],
  "üáºüá∏ Apia (Samoa)":             [-13.8333,-171.7667],
  "üá´üáØ Suva (Fiyi)":              [-18.1248,178.4501],
  "üá≥üáø Auckland":                 [-36.8485,174.7633],
  "üá≥üáø Wellington":               [-41.2865,174.7762],
  "üá¶üá∫ S√≠dney":                   [-33.8688,151.2093],
  "üá¶üá∫ Townsville":               [-19.2589,146.8169],
  "üá¶üá∫ Cairns":                   [-16.9186,145.7781],
  "üáµüá≠ Manila":                   [14.5995,120.9842],
  "üáπüáº Keelung":                  [25.1283,121.7419],
  "üáØüáµ Ishigaki":                 [24.3400,124.1550],
  "üáØüáµ Naha":                     [26.2123,127.6792],
  "üáØüáµ Tokio":                    [35.6762,139.6503],
  "üáØüáµ Nagasaki":                 [32.7503,129.8777],
  "üá∞üá∑ Busan":                    [35.1796,129.0756],
  "üá®üá≥ Shanghai":                 [31.2304,121.4737],
  "üá®üá≥ Hong Kong":                [22.3193,114.1694],
  "üáªüá≥ Hue Da Nang":              [16.0544,108.2022],
  "üá∏üá¨ Singapur":                 [1.3521,103.8198],
  "üá≤üáæ Port Klang Kuala":         [2.9983,101.3510],
  "üá≤üáæ Penang":                   [5.4141,100.3288],
  "üá∏üá® Port Victoria, isla Mah√©": [-4.6191,55.4513],
  "üá≤üá∫ Port Louis":               [-20.1609,57.5012],
  "üá∑üá™ La Possession":            [-20.9220,55.3380],
  "üáøüá¶ Cape Town":                [-33.9249,18.4241],
  "üá≥üá¶ Walvis Bay":               [-22.9576,14.5053],
  "üá®üáª Mindelo":                  [16.8901,-24.9804],
  "üáÆüáπ Civitavecchia":            [42.0924,11.7969],
  "üáÆüáπ Livorno":                  [43.5485,10.3106],
  "üáÆüáπ G√©nova":                   [44.4056,8.9463],
  "üá´üá∑ Marsella":                 [43.2965,5.3698]
};

// Colores por regi√≥n
const regionColors = {
  EUROPA:          "#1976D2",
  ATLANTICO:       "#FB8C00",
  PACIFICO_AMERICA:"#E53935",
  PACIFICO_OCEANIA:"#8E24AA",
  ASIA:            "#7CB342",
  INDICO_AFRICA:   "#00ACC1"
};

// ---------------------------
// Creaci√≥n del mapa
// ---------------------------

const map = L.map('map', {
  worldCopyJump: true
}).setView([10, 0], 2);

// Capa base CartoDB Positron (clara y limpia)
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  maxZoom: 18,
  attribution: '&copy; OpenStreetMap &copy; CartoDB'
}).addTo(map);

// Marcadores y ruta
const latlngs = [];

stops.forEach((stop, idx) => {
  const coords = coordMap[stop.puerto];
  if (!coords) return;

  latlngs.push(coords);

  const isFirst = (idx === 0); // inicio del viaje
  const numero = stop.orden;
  const region = stop.region || "ATLANTICO";
  const colorRegion = regionColors[region] || "#555";

  let background;
  let borderColor = "#FFFFFF";
  let textColor = "#FFFFFF";

  if (isFirst) {
    // Inicio / final Barcelona
    background = "radial-gradient(circle at 30% 30%, #c8e6c9 0%, #4caf50 40%, #1b5e20 100%)";
    borderColor = "#1b5e20";
    textColor = "#FFFFFF";
  } else {
    // Escalas seg√∫n regi√≥n
    background = colorRegion;
    borderColor = "#FFFFFF";
    textColor = "#FFFFFF";
  }

  const iconHtml = `
    <div style="
      background: ${background};
      color: ${textColor};
      border-radius: 50%;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      border: 2px solid ${borderColor};
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    ">
      ${numero}
    </div>
  `;
  const divIcon = L.divIcon({
    html: iconHtml,
    className: "",
    iconSize: [32, 32]
  });

  const marker = L.marker(coords, { icon: divIcon }).addTo(map);

  const llegada = stop.llegada ? stop.llegada : "‚Äî";
  const salida  = stop.salida  ? stop.salida  : "‚Äî";

  marker.bindPopup(`
    <b>Orden ${stop.orden} ‚Äì ${stop.puerto}</b><br>
    Regi√≥n: ${region.replace("_", " ")}<br>
    Fecha: ${stop.fecha}<br>
    D√≠a: ${stop.dia}<br>
    Temperatura: ${stop.temperatura}<br>
    Llegada: ${llegada}<br>
    Salida: ${salida}
  `);
});

// Ruta tropical / atardecer (sin cambios)
L.polyline(latlngs, {
  color: '#004d40',
  weight: 8,
  opacity: 0.35
}).addTo(map);

L.polyline(latlngs, {
  color: '#00bfa5',
  weight: 5,
  opacity: 0.95
}).addTo(map);

L.polyline(latlngs, {
  color: '#ff6f00',
  weight: 3,
  opacity: 0.9,
  dashArray: '8, 8'
}).addTo(map);

// Ajustar vista a toda la ruta
map.fitBounds(L.latLngBounds(latlngs), { padding: [20, 20] });

</script>
</body>
</html>
